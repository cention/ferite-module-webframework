<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>The Hitch Hikers Guide to webframework</title>
<link rel="stylesheet" href="style.css" type="text/css">
</head><body>
<h1 class="documentTitle">The Hitch Hikers Guide to webframework</h1><a name="toc" /><h3 class="tocTitle">Table of Contents</h3><blockquote class="toc"><a href="#introduction.title">1. Introduction</a><br /><span style="color:#fff;">____</span><a href="#intro-open.title">1.1. webframework</a><br /><span style="color:#fff;">____</span><a href="#intro-background.title">1.2. Background</a><br /><br /><a href="#requirements.title">2. Requirements</a><br /><br /><a href="#setup.title">3. Setup</a><br /><span style="color:#fff;">____</span><a href="#localconfig.title">3.1. Local Configuration: Application Specific Values</a><br /><br /><a href="#basics.title">4. Basics: Creating An Empty Application</a><br /><br /><a href="#structure.title">5. The Structure of an Application and the Server</a><br /><br /><a href="#pages.title">6. (Canadian) Pages: What are they all aboot ?</a><br /><span style="color:#fff;">____</span><a href="#61-pagefile">6.1. Page file:</a><br /><span style="color:#fff;">____</span><a href="#62-page-controllerfile">6.2. Page-Controller file:</a><br /><span style="color:#fff;">____</span><a href="#63-letsmakesomechanges">6.3. Lets make some changes!</a><br /><br /><a href="#storedobjects.title">7. Database Stored Objects</a><br /><span style="color:#fff;">____</span><a href="#71-creatingdata">7.1. Creating Data</a><br /><span style="color:#fff;">____</span><a href="#72-gettingitback">7.2. Getting It Back</a><br /><span style="color:#fff;">____</span><a href="#73-puttingitintoaction">7.3. Putting it into action!</a><br /><span style="color:#fff;">____</span><a href="#74-otherfeaturesofstoredobject">7.4. Other Features of StoredObject</a><br /><br /><a href="#8-pagesreloadedtemplates">8. Pages Reloaded: Templates</a><br /><span style="color:#fff;">____</span><a href="#81-pagetemplates">8.1. Page Templates</a><br /><span style="color:#fff;">____</span><a href="#82-smalltemplates">8.2. Small Templates</a><br /><br /><a href="#components.title">9. Components: 42</a><br /><span style="color:#fff;">____</span><a href="#91-standardcomponent">9.1. Standard Component</a><br /><span style="color:#fff;">____</span><a href="#92-strikeclassstrikeepicstrikecontainercomponents">9.2. <strike class="strike">[Epic]</strike> Container Components</a><br /><br /><a href="#i18n.title">10. Internationalisation (i18n)</a><br /><span style="color:#fff;">____</span><a href="#101-taggingstrings">10.1. Tagging Strings</a><br /><span style="color:#fff;">____</span><a href="#102-thestringsfileandhowtotranslate">10.2. The strings file and how to translate</a><br /><span style="color:#fff;">____</span><a href="#103-loadingacatalog">10.3. Loading A Catalog</a><br /><br /><a href="#ajax.title">11. Asynchronous Mechanisms: AJAX to you and me.</a><br /><span style="color:#fff;">____</span><a href="#111-fetchingcustomdata">11.1. Fetching Custom Data</a><br /><span style="color:#fff;">____</span><a href="#112-customajaxchannels">11.2. Custom AJAX Channels</a><br /><br /><a href="#12-databaselayer">12. Database Layer</a><br /><br /><a href="#documents.title">13. Documents. And their fore-fathers.</a><br /><br /><a href="#advanced.title">14. Advanced Topics</a><br /><span style="color:#fff;">____</span><a href="#141-security">14.1. Security</a><br /><span style="color:#fff;">____</span><span style="color:#fff;">____</span><a href="#1411-structure">14.1.1. Structure</a><br /><span style="color:#fff;">____</span><a href="#142-cachingandcachetriggers">14.2. Caching and Cache Triggers</a><br /></blockquote><hr class="documentStart" /><a name="introduction"></a><a name="introduction.title"></a><h1 class="sectionTitle">1. Introduction<a href="#toc"><img border="0" src="http-int.png" /></a></h1><blockquote class="section"><a name="intro-open"></a><a name="intro-open.title"></a><h2 class="sectionTitle">1.1. webframework<a href="#toc"><img border="0" src="http-int.png" /></a></h2><blockquote class="section"><p class="para"><tt class="monospace">webframework</tt> is an advanced web application development framework written in the <tt class="monospace">ferite</tt> programming				language. The framework provides a number of sophisticated layers on which to build excellent web applications.				These include flexible user interface components, an advanced zone based security layer, sanitised urls,				a stored object based database layer, great internationalisation support, page designer and developer friendly				structure, versioning document layer and most of all, a clean model-view-controller design.</p></blockquote><a name="intro-background"></a><a name="intro-background.title"></a><h2 class="sectionTitle">1.2. Background<a href="#toc"><img border="0" src="http-int.png" /></a></h2><blockquote class="section"><p class="para">				Chris Ross, the author of <tt class="monospace">ferite</tt>, wrote <tt class="monospace">webframework</tt> as a mechanism for developing and maintaining complex				web applications in the modern world wide web. It provides a very different method for web development and 				removes much of the repetitive nature of writing web sites.</p></blockquote></blockquote> <hr class="sectionSplitter" /><a name="requirements"></a><a name="requirements.title"></a><h1 class="sectionTitle">2. Requirements<a href="#toc"><img border="0" src="http-int.png" /></a></h1><blockquote class="section"><p class="para"><tt class="monospace">webframework</tt> requires the latest <tt class="monospace">ferite</tt> release (1.1.0) which includes directives. It also relies on the modules:			xslt, template, image, dbi and embfer. It will not work without these modules. They can be found in the top-level 			modules directory in ferite cvs. Or upon release, on the download site. You will also need either MySQL or PosgreSQL			installed and have a database set up for use within the system. We strongly recommend PostgreSQL for use with 			webframework. You will also need <tt class="monospace">apache</tt> 2.x running <tt class="monospace">mod_ferite</tt> (the apache			module).</p></blockquote> <hr class="sectionSplitter" /><a name="setup"></a><a name="setup.title"></a><h1 class="sectionTitle">3. Setup<a href="#toc"><img border="0" src="http-int.png" /></a></h1><blockquote class="section"><p class="para">			Configuration.feh.sample is where you start. This can be found within the Server/Support/ directory within the 			distribution. Copy it to Configuration.feh and open it up into your favourite editor. At the current time of writing			the configuration looks like this:		</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br />22<br />23<br /></pre></td><td><pre class="code-linesright">namespace Config {

&nbsp;&nbsp;&nbsp;&nbsp;string DbType = "mysql";
&nbsp;&nbsp;&nbsp;&nbsp;string DbUsername = "";        
&nbsp;&nbsp;&nbsp;&nbsp;string DbPassword = ""; 
&nbsp;&nbsp;&nbsp;&nbsp;string DbHost = "localhost";
&nbsp;&nbsp;&nbsp;&nbsp;string DbDatabase = "webframework";
&nbsp;&nbsp;&nbsp;&nbsp;string DbTablePrfx = ""; // Leave this empty for the moment

&nbsp;&nbsp;&nbsp;&nbsp;string Root = ""; // The host the system runs on
&nbsp;&nbsp;&nbsp;&nbsp;string RootOffset = "webframework"; // Directory from the root 
&nbsp;&nbsp;&nbsp;&nbsp;string AppDefault = ""; // The default application

&nbsp;&nbsp;&nbsp;&nbsp;string FSDataDirectory = "/path/to/webframework/Data";
&nbsp;&nbsp;&nbsp;&nbsp;string URLDataDirectory = "/webframework/Data;

&nbsp;&nbsp;&nbsp;&nbsp;boolean Debug = false;
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;namespace Defaults {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string Language = "EN.UK";
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string DateFormat = '%Y/%m/%d';
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre></td></tr></table><p class="para">			There are a number of options to be set and will be valid across all your applications. Any option presented above and not mentioned below 			be safely ignored.			<ul class="list"><li class="listItem"><p class="listItemParagraph"><p class="para">DbType: this is the type of the database you wish to use. For MySQL choose mysql, for PostgreSQL choose pgsql.</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para">DbUsername: the user name for the database.</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para">DbPassword: the password to use.</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para">DbHost: the on which the database is running. If running locally, keep it as localhost.</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para">DbDatabase: the name of the database to use.</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para">					Root: This is the root of the <tt class="monospace">webframework</tt>installation on the web server. It is safe to leave this blank unless you wish <tt class="monospace">webframework</tt> to 					bind to a specific name. For instance "http://www.foobar.com".</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para">					RootOffset: How to reach the top-level <tt class="monospace">webframework</tt> directory from the host. For instance, if you installed <tt class="monospace">webframework</tt> into the					top level document directory of your web-server, you would put "webframework" in this field.</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para">					AppDefault: If you are only going to have one application, it's name should be placed here and <tt class="monospace">webframework</tt> will always route non-specific					requests to the application. However, if you have multiple applications, you can leave this blank and <tt class="monospace">webframework</tt> will provide an application					list.</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para">					FSDataDirectory: <tt class="monospace">webframework</tt> provides some data services that allow applications to generate, store and retrieve information during run-time					making it easier to manage the multiple application design nature of the system. This is the disk path to the data directory. It is suggested that					this directory is placed within the <tt class="monospace">webframework</tt> top level directory.</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para">					URLDataDirectory: The dual to FSDataDirectory, this is the web accessible path to the afore mentioned data directory. This should be an absolute					path from the root of the web site.				</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para">					Debug: If this <tt class="monospace">boolean</tt> variable is set to <tt class="monospace">true</tt>, <tt class="monospace">webframework</tt> will operate within debug mode					injecting various tools at the top of each page.</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para">					Defaults.Language: This is the default system language. As <tt class="monospace">webframework</tt> provides a clean internationalisation system, you can specify the					default strings file to use.</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para">					Defaults.DateFormat: This is the default date format that the applications within the system should use to present dates to the user.				</p></p></li></ul>			Once you have configured your database connection you can run the <tt class="monospace">TestDB.fe</tt> script in the tools directory.</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br /></pre></td><td><pre class="code-linesright">webframework$ ferite Tools/TestDB.fe                                      
Success! Your database and configuration are working!</pre></td></tr></table><p class="para">			If everything is working well, you will have a the above message stating that all is well. If everything has gone wrong, you will get			something that looks like this:		</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br /></pre></td><td><pre class="code-linesright">webframework$ ferite Tools/TestDB.fe
Error! Your database and configuration are NOT working!
Error: Unable to connect to database: 'could not connect to server: No such file or directory
        Is the server running locally and accepting
        connections on Unix domain socket "/tmp/.s.PGSQL.5432"?
'</pre></td></tr></table><p class="para">			This will also flag any issues with module loading that might inhibit <tt class="monospace">webframework</tt>'s ability to run. 			There are two other things we must do before we test the framework. You must check that the top-level <tt class="monospace">Cache</tt> and data			directories are write-able by the web-server. Once that is done, we can now test that the webframework			is working, by directing our browser at the web-server. You need to simply go to the root or the <tt class="monospace">webframework</tt> directory and you should			see something like this.</p><img src="wf_applist.png" align="center" /><p class="para">			The application list is the set of basic applications that come with <tt class="monospace">webframework</tt>, we will ignore those for the moment and create an application 			to play with.		</p><a name="localconfig"></a><a name="localconfig.title"></a><h2 class="sectionTitle">3.1. Local Configuration: Application Specific Values<a href="#toc"><img border="0" src="http-int.png" /></a></h2><blockquote class="section"><p class="para">				There are times when you wish to host multiple applications within the same webframework installation but have different default values. For				instance you may want debugging turned on for a particular application and have the others working in production mode, or have a particular				application using a different database. This can be achieved using the <tt class="monospace">LocalConfiguration.feh</tt> file within the applications's<tt class="monospace">Support</tt> directory. You may also want to setup some global configuration for that application and not have it appear in				another application, either way, this mechanism provides a nice clean way of doing things.</p><p class="para">				You need to create a file called <tt class="monospace">LocalConfiguration.feh</tt> and create a namespace within it called <tt class="monospace">LocalConfig</tt>.				This file should have the same structure as the standard <tt class="monospace">Configuration.feh</tt> file, but only contain the values you wish 				to <i class="emphasis">overwrite</i> or add the the <tt class="monospace">Config</tt> namespace. For instance, if I want the application to connect to a				different database, I would fill the file with:</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br /></pre></td><td><pre class="code-linesright">namespace LocalConfig {
&nbsp;&nbsp;&nbsp;&nbsp;string DbType = "pgsql";
&nbsp;&nbsp;&nbsp;&nbsp;string DbUsername = "chris";
&nbsp;&nbsp;&nbsp;&nbsp;string DbPassword = "";
&nbsp;&nbsp;&nbsp;&nbsp;string DbHost = "localhost";
&nbsp;&nbsp;&nbsp;&nbsp;string DbDatabase = "arctic";
}</pre></td></tr></table><p class="para">				If I wanted to turn on <tt class="monospace">Debug</tt> for a particular application, I would use this:</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br /></pre></td><td><pre class="code-linesright">namespace LocalConfig {
&nbsp;&nbsp;&nbsp;&nbsp;boolean Debug = true;
}</pre></td></tr></table><p class="para">				You do <i class="emphasis">not</i> need to include the <tt class="monospace">LocalConfiguration.feh</tt> file, <tt class="monospace">webframework</tt> will automatically import it if it exists.</p></blockquote></blockquote> <hr class="sectionSplitter" /><a name="basics"></a><a name="basics.title"></a><h1 class="sectionTitle">4. Basics: Creating An Empty Application<a href="#toc"><img border="0" src="http-int.png" /></a></h1><blockquote class="section"><p class="para">			Creating a basic application is as easy as running a script. It will build the basic application, populate the database with the required tables,			and register the security details. We shall create a task tracking application which we will call "tasks". In the <tt class="monospace">webframework</tt> Tools directory, 			we need to run the following script:</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br /></pre></td><td><pre class="code-linesright">Tools$ ferite CreateBasicApplication.fe -- tasks ../Applications/
Creating application 'tasks' in '../Applications/'
Writing out index.fe
Writing out App.fe
Writing out Main.page
Writing out Main.page.fe
Injecting SQL code for application
Done!</pre></td></tr></table><p class="para">			We can now refresh our application list and our application should appear:		</p><img src="wf_applist_tasks.png" align="center" /><p class="para">			Clicking on our application will take us to the application's main page: (Note the clean url)		</p><img src="wf_tasks_main.png" align="center" /><p class="para">			We can even click on the button:		</p><img src="wf_tasks_main_clicked.png" align="center" /><p class="para">			So there we have it: a basic application. The next set of sections will detail what the structure of the system is, what pages are and 			how to make the application do something clever and useful with components and store objects.		</p></blockquote> <hr class="sectionSplitter" /><a name="structure"></a><a name="structure.title"></a><h1 class="sectionTitle">5. The Structure of an Application and the Server<a href="#toc"><img border="0" src="http-int.png" /></a></h1><blockquote class="section"><p class="para">			The most important idea behind <tt class="monospace">webframework</tt>is that of structure. Keep things consistent and maintenance is made easier. Each application			has a Pages, Resources and Support directory. 		</p><img src="wf_app_layout.png" align="center" /><p class="para">			In each of these directories only specific things should appear:			<ul class="list"><li class="listItem"><p class="listItemParagraph"><p class="para">						Pages: This is the location of the component based pages and controller classes for the page. The only files that should be						present within this directory are page files (<tt class="monospace">.page</tt>) and page-controller files (<tt class="monospace">.page.fe</tt>). 						<tt class="monospace">Page</tt> files are XML based documents that describe the look and layout of the page, these should, strictly 						speaking be completely be clean of code. This is true 99% of the time with the 1% described later in this document.<tt class="monospace">Page-Controller</tt> files are the controller for the page files and provide the operating logic for the page. This						separation is exceedingly important and provides a great environment for developers and designers to move freely within the						application source without stepping on each others toes. Pages are covered within the next section and provide the interface 						for the web applications.</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para">						Resources: All static content should be placed within this directory and very much to a strict directory layout. <tt class="monospace">webframework</tt> does resource stacking. This means that part of the system can request a resource of a certain type, and <tt class="monospace">webframework</tt> will first 						look in the applications resource directory, if it exists the framework will use it, otherwise it'll then look for the resource						in <tt class="monospace">webframework</tt>. How is this useful ? Due to the large amount of resources that <tt class="monospace">webframework</tt> provides - you can, and most likely						will want to, override the defaults such as images, style or layout. It is as simple as placing a file in the resource directory						of your application. For instance, to change the default html that is generated when a button is rendered - simply copy the webframework						template, change it and then save it to the <tt class="monospace">Templates</tt> directory within the <tt class="monospace">Resources</tt> directory.						Now, whenever a button is rendered, they will all use your new template as it will override the default one. The directories that						are used are called <tt class="monospace">CSS</tt> for css style sheets, <tt class="monospace">Images</tt> for images, <tt class="monospace">Javascript</tt>						for javascript monospaces and <tt class="monospace">Templates</tt> for templates (covered more within the section on Components).</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para">						Support: Code goes here. We recommend that you place your code in this directory. <tt class="monospace">webframework</tt> will not load any code automatically,						so it in necessary to include your files. This approach is part of the defensive opt-in strategy <tt class="monospace">webframework</tt> employs for various						sections of the system which is explained in much more detail within the Security section of this document (In a nutshell: <tt class="monospace">webframework</tt>						keeps everything locked down by default and requires you, as the developer, to open up the system which should help reduce unforeseen						security holes.) To keep with good organisation, it is also recommended that components are placed within the <tt class="monospace">Components</tt>						directory within <tt class="monospace">Support</tt>.					</p></p></li></ul>			The <tt class="monospace">App.fe</tt> file is the core application file that provides the details to help the application run - such as page registration,			application title, simple actions and redirects. We can check the anatomy of a basic <tt class="monospace">App.fe</tt> file:</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br /></pre></td><td><pre class="code-linesright">// Automatically created by CreateBasicApplication.fe for BugTrack
class tasksApplication extends Application {
&nbsp;&nbsp;&nbsp;&nbsp;constructor {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super("tasks");

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.registerPage('Main');

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;redirects.register( Application.NoAction, "Main" );
&nbsp;&nbsp;&nbsp;&nbsp;}
}
return new tasksApplication();</pre></td></tr></table><p class="para">			Line 2 shows the application class extending the <tt class="monospace">Application</tt> class. Line 4 shows the constructor being called along with the			name of the application. Line 6 shows the registration of the page <tt class="monospace">Main</tt>. Line 8 is a standard line that tells <tt class="monospace">webframework</tt> to			redirect the <tt class="monospace">NoAction</tt> request to <tt class="monospace">Main</tt>. NoAction is generated when the application is called blind, e.g.			<tt class="monospace">http://localhost/webframework/App.fe/tasks</tt>. Line 11 returns an instance of our application class for the <tt class="monospace">webframework</tt>to use.		</p><p class="para">			The <tt class="monospace">index.fe</tt> simply does a force redirect to <tt class="monospace">webframework</tt> if someone stumbles into the application directory. It looks like			this:</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br /></pre></td><td><pre class="code-linesright">Request.current().location( "../../App.fe/tasks" );</pre></td></tr></table><p class="para">			Server layout should be familiar:		</p><img src="wf_server_layout.png" align="center" /><p class="para">			Consistency. The key to an easy life. Well, easier. The server layout is identical to the application layout and all resources are shared			between all applications. There are however much more resources within the Server directory and we suggest you take a look around. You will			note the Page and Page-Controller files that are within the Server/Pages directory. If you want to overload the Login or Error page ?			Provide a new Page file with the correctly name components - the logic does not need to be replaced.		</p></blockquote> <hr class="sectionSplitter" /><a name="pages"></a><a name="pages.title"></a><h1 class="sectionTitle">6. (Canadian) Pages: What are they all aboot ?<a href="#toc"><img border="0" src="http-int.png" /></a></h1><blockquote class="section"><p class="para">			We know they exist, we know where to put them, we <i class="emphasis">even know</i> that they are made up of two files - the layout 'Page' and			the logic 'Controller'. First of all, we shall look at the files generated for us by <tt class="monospace">CreateBasicApplication.fe</tt>, go			through the main points of both files and then make a number of small modifications, then go in and start playing with the heavy machinery.			Watch out, you should probably put your coffee down.		</p><a name="pages.page"></a><a name="61-pagefile"></a><h2 class="sectionTitle">6.1. Page file:<a href="#toc"><img border="0" src="http-int.png" /></a></h2><blockquote class="section"><p class="para">				To build a page that looks like this:			</p><img src="wf_tasks_main.png" align="center" /><p class="para">				You need a page file that looks like this:			</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br /></pre></td><td><pre class="code-linesright">&lt;!-- Automatically created by CreateBasicApplication.fe for tasks --&gt;
&lt;wf:Label ID="DocumentTitle" FontSize="24px" TextValue="Welcome to tasks" /&gt; &lt;br /&gt;
&lt;wf:Button ID="ClickButton" TextValue="Click Me!" /&gt;
&lt;wf:TextField ID="ClickField" /&gt;</pre></td></tr></table><p class="para">				So, here we have a page file, there are 3 components detailed on this page, a <tt class="monospace">Label</tt> on line 2, a <tt class="monospace">Button</tt> on line 3 and a <tt class="monospace">TextField</tt> on line 4. These build the page and produce a page as seen above. The first thing to note, 				these page files must be valid xml for <tt class="monospace">webframework</tt>to parse them. This can be deemed strict but remember, we are aiming for high standards and easy 				maintenance and as little sloppiness as possible. What does <tt class="monospace">webframework</tt>do with the page file when loaded ? It first applies a header and footer				from a defined template (detailed later), parses the produced page and builds the components, connects the components with the logic and executes any 				code than needs to be run. Much of this process is cached and thus exceedingly fast on subsequent loads. Components are references by defining items within				the <tt class="monospace">wf</tt> xml namespace along with the name of the component. It you wish to access a component in the controller you will				need to specify an identifier with the <tt class="monospace">ID</tt> attribute. You can happily mix html and components with each other which is where				the power comes - the developer can build a basic page with the components and then let the designer build the layout and tweak the interface, the				designer only needs to know or define the ID's of the components being used. So, how do we make the page do something ? The controller.</p></blockquote><a name="pages.controller"></a><a name="62-page-controllerfile"></a><h2 class="sectionTitle">6.2. Page-Controller file:<a href="#toc"><img border="0" src="http-int.png" /></a></h2><blockquote class="section"><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br />12<br />13<br />14<br />15<br /></pre></td><td><pre class="code-linesright">// Automatically created by CreateBasicApplication.fe for tasks
class MainPage extends GUIKit.Page {
&nbsp;&nbsp;&nbsp;&nbsp;[component DocumentTitle]; // Automatically bound by webframework
&nbsp;&nbsp;&nbsp;&nbsp;[component ClickButton]; // Automatically bound by webframework
&nbsp;&nbsp;&nbsp;&nbsp;[component ClickField]; // Automatically bound by webframework

&nbsp;&nbsp;&nbsp;&nbsp;function initialiseComponents() {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Add Component initialisation code here
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ClickButton.registerEventHook( self, "button_clicked", GUIKit.EvClick );
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;function button_clicked( object sender, string extra ) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ClickField.setTextValue("You clicked!");
&nbsp;&nbsp;&nbsp;&nbsp;}
}
return MainPage;</pre></td></tr></table><p class="para">				A page controller is a class that extends a <tt class="monospace">GUIKit.Page</tt>, has a set of <tt class="monospace">[component]</tt> directives,				a <tt class="monospace">initialiseComponents</tt>, an optional <tt class="monospace">pageLoaded</tt> function, a set of optional event handlers and				a number of overloaded functions to drive how content is delivered to the client.</p><p class="para">				In the above example you can see a number of <tt class="monospace">[component]</tt> directives. These tell <tt class="monospace">webframework</tt> to create variables				called by the name in the directive and link it to the component within the page file with the same name. This allows you to transparently				access the components within the layout as if they are instance variables - you do not need to manually locate and set them up. This can				be seen by the variables use on line 9 and 12, when the button event handler has been setup and the text value of the edit box are done				respectively.</p><p class="para">				It is important to understand the way in which <tt class="monospace">webframework</tt> processes a page to use them effectively. When it loads the page, it resets				it to an initial state and calls <tt class="monospace">initialiseComponents</tt>, where it is normal for a page controller to setup links for				data sources, event handlers etc. If it is not the first load of the page for the specific client, (say a button has been clicked), the				system will set all components to their previous state, update changed components. Then <tt class="monospace">pageLoaded</tt> will be called.				If there are any event handlers	it will invoke them, then the page will be built and delivered to the client.</p><p class="para">				In the above example, we register a click handler on <tt class="monospace">ClickButton</tt> on line 9 to call our <tt class="monospace">button_clicked</tt>				function. Our event handler (line 11) takes two arguments: the object that causes the event handler to be fired and a string <tt class="monospace">extra</tt>				which can be set when we register our event handler to be passed back to us. Within our event handler we change the text value of the 				<tt class="monospace">TextField</tt> to <i class="emphasis"><strong class="strong">You clicked!</strong></i>. This should hopefully demonstrate the crux of <tt class="monospace">webframework</tt>, 				your area of concern is reacting to changes within the system: you don't need to worry about storing, sending, decoding and dealing with all				components. It brings the world of state-full programming to the web.			</p></blockquote><a name="pages.makingchanges"></a><a name="63-letsmakesomechanges"></a><h2 class="sectionTitle">6.3. Lets make some changes!<a href="#toc"><img border="0" src="http-int.png" /></a></h2><blockquote class="section"><p class="para">				First we are going to change the page file. As we are building an application to store a set of tasks, lets add a <tt class="monospace">TextView</tt> component to store the body of the task, a <tt class="monospace">Calendar</tt> component to allow us to pick when the task should be completed by,				and a <tt class="monospace">PopupButton</tt> to allow us to select how urgent the task is.</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br /></pre></td><td><pre class="code-linesright">&lt;!-- Automatically created by CreateBasicApplication.fe for tasks --&gt;
&lt;wf:Label ID="DocumentTitle" FontSize="24px" TextValue="Welcome to tasks" /&gt; &lt;br /&gt;
Title: &lt;wf:TextField ID="TaskTitle" /&gt; &lt;br /&gt;
Contents: &lt;br /&gt; &lt;wf:TextView ID="TaskContents" TextValue="" /&gt; &lt;br /&gt;
Complete by: &lt;wf:Calendar ID="TasKCompleteBy" /&gt; &lt;br /&gt;
Priority: &lt;wf:PopupButton ID="TaskPriority" /&gt; &lt;br /&gt;
&lt;wf:Button ID="ClickButton" TextValue="Add Task" /&gt;</pre></td></tr></table><p class="para">				We have renamed our TextField, added a TextView with the ID <tt class="monospace">TaskContents</tt> on line 4, a <tt class="monospace">Calendar</tt> called<tt class="monospace">TaskCompletedBy</tt> on line 5 and our <tt class="monospace">PopupButton</tt> on line 6. If we refresh this page, we get something that				should look like this:</p><img src="wf_tasks_newmain_noinit.png" align="center" /><p class="para">				This is what we need, however, we need to provide some priorities and could probably make the calendar component more useful by setting it to todays				date. This is done by changing the controller file to look something more like below.			</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br /></pre></td><td><pre class="code-linesright">class MainPage extends GUIKit.Page {
&nbsp;&nbsp;&nbsp;&nbsp;[component DocumentTitle]; // Automatically bound by webframework
&nbsp;&nbsp;&nbsp;&nbsp;[component ClickButton]; // Automatically bound by webframework
&nbsp;&nbsp;&nbsp;&nbsp;[component TaskTitle, TaskContents, TaskCompleteBy, TaskPriority]; 

&nbsp;&nbsp;&nbsp;&nbsp;function initialiseComponents() {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Add Component initialisation code here
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ClickButton.registerEventHook( self, "button_clicked", GUIKit.EvClick );
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.TaskCompleteBy.setDate( Date.now() );
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.TaskPriority.setDataSource( [
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 1, 'Low' ],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 2, 'Medium' ],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 3, 'High' ]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;] ); 
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;function button_clicked( object sender, string extra ) {

&nbsp;&nbsp;&nbsp;&nbsp;}
}
return MainPage;</pre></td></tr></table><p class="para">				This hooks up to the new components (line 4), sets the date on the calendar component (line 9) and provides a set of priorities to the popup button				(lines 10-14). How does this look ? Refresh the page and it should look something similar to this:			</p><img src="wf_tasks_newmain.png" align="center" /><p class="para">				So there you have it, more components, components initialised, data we just have to put it somewhere. This is where database stored objects 				save the day, the next section is just for you.			</p></blockquote></blockquote> <hr class="sectionSplitter" /><a name="storedobjects"></a><a name="storedobjects.title"></a><h1 class="sectionTitle">7. Database Stored Objects<a href="#toc"><img border="0" src="http-int.png" /></a></h1><blockquote class="section"><p class="para">			What is a stored object ? In a nutshell it is a bridge between a ferite class and a table row. You specify the table and the map between the table			and your instance variables within the object, you can then load and save objects to and from the database. They provide a natural way of abstractly			interfacing with a relational database. The best way to explain their use is to demonstrate with our tasks example.         </p><a name="storedobjects.creating"></a><a name="71-creatingdata"></a><h2 class="sectionTitle">7.1. Creating Data<a href="#toc"><img border="0" src="http-int.png" /></a></h2><blockquote class="section"><p class="para"> First we will create a database table: (this one is in a PostgreSQL database) </p><img src="wf_tasks_table.png" align="center" /><p class="para"> Now we need to write our class: firstly we create a Task.feh in our Support directory and write out stored object map: </p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br />12<br />13<br />14<br />15<br /></pre></td><td><pre class="code-linesright">class Task extends Database.StoredObject {
&nbsp;&nbsp;&nbsp;&nbsp;string title = '';
&nbsp;&nbsp;&nbsp;&nbsp;string contents = '';
&nbsp;&nbsp;&nbsp;&nbsp;number completedBy = 0;
&nbsp;&nbsp;&nbsp;&nbsp;number priority = 0;

&nbsp;&nbsp;&nbsp;&nbsp;constructor {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super( 'tasks', [
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'title' =&gt; 'title',
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'contents' =&gt; 'contents',
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'completeby' =&gt; 'completedBy',
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'priority' =&gt; 'priority'
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;] );
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre></td></tr></table><p class="para"> There are a couple of things to note: line 1 shows the class extending <tt class="monospace">Database.StoredObject</tt>, line 8-13 shows the parent                constructor being called. The first argument is the name of the database table to use and raises an interesting point. The table we created                was called <tt class="monospace">tasks_tasks</tt> but we call it <tt class="monospace">tasks</tt>, this is because <tt class="monospace">webframework</tt> assumes all tables                are prefixed with the application name - this ultimately reduces the number of conflicts between applications. The second argument to the                 parent constructor is an associated array where the keys are the names of the database columns and the value is the local variable to attach                it to. It is now ready for use. </p><p class="para"> Secondly we need to tell our application source about our new: </p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br /></pre></td><td><pre class="code-linesright">uses "Support/Task";</pre></td></tr></table><p class="para"> We can now use our Task class in our page file. The aim is to, when the <tt class="monospace">Add</tt> button is clicked, to create an object and                the save it to our database. How tricky is that ? Not very. Lets modify our click handler and see how we use the object: </p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br /></pre></td><td><pre class="code-linesright">function button_clicked( object sender, string extra ) {
&nbsp;&nbsp;&nbsp;&nbsp;object task = new Task();
&nbsp;&nbsp;&nbsp;&nbsp;task.title = .TaskTitle.textValue();
&nbsp;&nbsp;&nbsp;&nbsp;task.contents = .TaskContents.textValue();
&nbsp;&nbsp;&nbsp;&nbsp;task.completedBy = .TaskCompleteBy.date();
&nbsp;&nbsp;&nbsp;&nbsp;task.priority = .TaskPriority.selectedItem();
&nbsp;&nbsp;&nbsp;&nbsp;task.saveObject();
}</pre></td></tr></table><p class="para"> The above code creates the object and then assigns the various component values from the page to the objects variables. The important line                is line 7; <tt class="monospace">saveObject</tt> tells the object to flush its values back to the database. This function will, if the object                already has an id update the object otherwise, as in our case, it will create a new row within the database and grab its id. For any subsequent                saves the object will use the newly created row and update it. This means that clicking <tt class="monospace">Add Task</tt> in the form below: </p><img src="wf_form_filled.png" align="center" /><p class="para"> Will generate the following database row: </p><img src="wf_dbdata.png" align="center" /><p class="para"> Having stored the data, it is now necessary to explore how to get it back! </p></blockquote><a name="storedobjects.gettingitback"></a><a name="72-gettingitback"></a><h2 class="sectionTitle">7.2. Getting It Back<a href="#toc"><img border="0" src="http-int.png" /></a></h2><blockquote class="section"><p class="para"><tt class="monospace">Database.StoredObject</tt> provides a number of strategies for getting your data back. We will start by looking at 				at the cleanest approaches and then delve into the dark dank world that is the raw SQL query.</p><p class="para">				To fetch an object back we can use the <tt class="monospace">loadObject</tt> function. This takes the id of the object you wish to load,				queries the database and populates the objects' variables.</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br /></pre></td><td><pre class="code-linesright">object task = new Task();
task.loadObject(2);</pre></td></tr></table><p class="para">				There are a number of other variations on the same theme that have the same effect. It is important to note the <tt class="monospace">loadCached</tt>				(line 3) has an extra feature: if you load the same object twice it will only query the database once, potentially reducing the number of 				database hits significantly.				 			</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br /></pre></td><td><pre class="code-linesright">object t1 = new Task(2);
object t2 = Task.load(2);
object t3 = Task.loadCached(2);</pre></td></tr></table><p class="para">				Loading an object directly is useful, however it is often the case that you don't know what the id is for an object or you wish to				output a list of objects. To get the list of objects of a certain type, you simply use the function <tt class="monospace">objectList</tt>.            </p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br /></pre></td><td><pre class="code-linesright">array list = Task.objectList();</pre></td></tr></table><p class="para">				This will fetch all the task objects out of our database and return an array of them. There is a variation of this function called				<tt class="monospace">objectListWhere</tt> that provides the ability to supply a SQL <tt class="monospace">WHERE</tt> clause. There is				another variation called <tt class="monospace">objectListWhereOrder</tt> which allows you to specify ordering information. 				For instance, you may only want to retrieve all objects that have a certain priority:</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br /></pre></td><td><pre class="code-linesright">array list1 = Task.objectListWhere('Priority=2');
array list2 = Task.objectListWhereOrder('Priority=2','CompleteBy ASC");</pre></td></tr></table><p class="para">				The other option is to talk to the database directly. This is useful when you have a very complicated query that results in 				wanting to load stored objects. First lets look at an example and then go through it: 			</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br /></pre></td><td><pre class="code-linesright">array list = [];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
string query = "SELECT * FROM ${Database.table('tasks')} ORDER BY CompleteBy ASC";
Database.query( query ) using ( array row ) {
&nbsp;&nbsp;&nbsp;&nbsp;list[] = Task.load(row);
};</pre></td></tr></table><p class="para">				There are a number of points to be covered:				<ul class="list"><li class="listItem"><p class="listItemParagraph"><p class="para">							Line 2: <tt class="monospace">Database.table</tt> is used to get the correct table name. It has been mentioned that <tt class="monospace">webframework</tt>							does table name prefixing to remove conflicts across applications, <tt class="monospace">Database.table</tt> will, given the							application specific name, return a string that has the correct table name. In our example it'll return<tt class="monospace">tasks_tasks</tt>.						</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para">							Line 3: <tt class="monospace">Database.query</tt> allows you to run a SQL query. If you do not provide a <tt class="monospace">using</tt>							block, the function will return the database result object (see the <tt class="monospace">dbi</tt> documentation). If you do							provide a using block, it must take a single argument that will be an array holding the current row information.</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para">							Line 4: Using the powers given to us by <tt class="monospace">ferite</tt>, the various methods to load an object will also accept a database							row! This means that you can easily load an object from an array.						</p></p></li></ul> Using these mechanisms we can now put a list of objects in the tasks applications and make it useful!</p></blockquote><a name="storedobjects.puttingitintoplay"></a><a name="73-puttingitintoaction"></a><h2 class="sectionTitle">7.3. Putting it into action!<a href="#toc"><img border="0" src="http-int.png" /></a></h2><blockquote class="section"><p class="para">				First off, we will clean up our page by putting a <tt class="monospace">Box</tt> component around the existing components, we will also				add a <tt class="monospace">List</tt> component called <tt class="monospace">TaskList</tt>. It now looks like this: (Note that the 				<tt class="monospace">Box</tt> components do not have an <tt class="monospace">ID</tt> attribute. <tt class="monospace">webframework</tt> will handle these components				automatically for you.)</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br />12<br />13<br />14<br />15<br /></pre></td><td><pre class="code-linesright">&lt;wf:Label ID="DocumentTitle" FontSize="24px" TextValue="Welcome to tasks" /&gt; &lt;br /&gt;

&lt;wf:Box TextValue="Existing Tasks"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;wf:List ID="TaskList" /&gt;
&lt;/wf:Box&gt;

&lt;p /&gt;

&lt;wf:Box TextValue="Add New Task"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;Title: &lt;wf:TextField ID="TaskTitle" /&gt; &lt;br /&gt;
&nbsp;&nbsp;&nbsp;&nbsp;Contents: &lt;br /&gt; &lt;wf:TextView ID="TaskContents" TextValue="" /&gt; &lt;br /&gt;
&nbsp;&nbsp;&nbsp;&nbsp;Complete by: &lt;wf:Calendar ID="TaskCompleteBy" /&gt; &lt;br /&gt;
&nbsp;&nbsp;&nbsp;&nbsp;Priority: &lt;wf:PopupButton ID="TaskPriority" /&gt; &lt;br /&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;wf:Button ID="ClickButton" TextValue="Add Task" /&gt; 
&lt;/wf:Box&gt;</pre></td></tr></table><p class="para">				When you reload the page in your browser it should look something like this:			</p><img src="wf_tasks_listempty.png" align="center" /><p class="para">				Now we need modify our page-controller and as is the general theme, we shall do it by example. Below is the new page-controller				code that is used with the main changes, for ease of reading, made bold.			</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br />22<br />23<br />24<br />25<br />26<br />27<br />28<br />29<br />30<br />31<br />32<br />33<br />34<br />35<br />36<br />37<br />38<br />39<br />40<br />41<br />42<br />43<br /></pre></td><td><pre class="code-linesright">class MainPage extends GUIKit.Page <strong class="strong">implements GUIKit.ListDataSource</strong> {
&nbsp;&nbsp;&nbsp;&nbsp;[component DocumentTitle, ClickButton];
&nbsp;&nbsp;&nbsp;&nbsp;[component TaskTitle, TaskContents, TaskCompleteBy, TaskPriority];
&nbsp;&nbsp;&nbsp;&nbsp;<strong class="strong">[component TaskList];</strong>

&nbsp;&nbsp;&nbsp;&nbsp;function initialiseComponents() {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ClickButton.registerEventHook( self, "button_clicked", GUIKit.EvClick );
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.TaskCompleteBy.setDate( Date.now() );
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.TaskPriority.setDataSource( [
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 1, 'Low' ],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 2, 'Medium' ],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 3, 'High' ] ] );
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong class="strong">.TaskList.setDataSource(self);</strong>
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;function button_clicked( object sender, string extra ) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object task = new Task();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;task.title = .TaskTitle.textValue();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;task.contents = .TaskContents.textValue();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;task.completedBy = .TaskCompleteBy.date();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;task.priority = .TaskPriority.selectedItem();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;task.saveObject();
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;<strong class="strong">array taskList;
&nbsp;&nbsp;&nbsp;&nbsp;function reloadData( object source ) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.taskList = Task.objectList();
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;function numberOfItems( object sender ) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return .taskList.size();
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;function identifierForItem( object sender, number index ) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return .taskList[index].objectID();
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;function renderForItem( object sender, number index ) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object task = .taskList[index];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string date = Date.date(task.completedBy).format(Config.Defaults.DateFormat);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return HTML.bold(task.title) + 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   ' &middot; Complete by: ' + HTML.bold(date) + 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   ' &middot; Priority: ' + HTML.bold(.TaskPriority.labelForItem(task.priority)) +
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   HTML.newline() + HTML.blockquote(task.contents);
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;function didSelectItem( object sender, string id );</strong>
}
return MainPage;</pre></td></tr></table><p class="para"><ul class="list"><li class="listItem"><p class="listItemParagraph"><p class="para">							Line 1: We keep things structured by using the <tt class="monospace">GUIKit.ListDataSource</tt> protocol,							this requires us to define five functions <tt class="monospace">reloadData</tt>, <tt class="monospace">numberOfItems</tt>,							<tt class="monospace">identifierForItem</tt>, <tt class="monospace">renderForItem</tt> and <tt class="monospace">didSelectItem</tt>.						</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para">							Line 4: Add out <tt class="monospace">TaskList</tt> component to our bindings.</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para">							Line 13: The <tt class="monospace">setDataSource</tt> function tells the list to use us as the data source.</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para">							Line 23: The data storage.						</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para">							Line 24-26: The <tt class="monospace">reloadData</tt> function; the List component calls this before it requests 							any information from us as a data source. In the example we use this opportunity to load the task list from							the database.</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para">							Line 27-29: The <tt class="monospace">numberOfItems</tt> function is used by the list to query how many items there							are within the list.</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para">							Line 30-32: The <tt class="monospace">identifierForItem</tt> is called when the List wants to know what the id is for							the specific row within the list. It provides the <tt class="monospace">index</tt> parameter as index into the data							set. You may return nothing from the function, however, if you want to allow the selection of items within the 							list - you will need the id.</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para">							Line 33-41: The <tt class="monospace">renderForItem</tt> function is used to get the output of what the list element							looks like. Within the function we use the <tt class="monospace">HTML</tt> toolbox functions to add some formating.							You are probably thinking that the function is very cluttered and doesn't have the elegance you have come to							expect. You are right. In the next chapter we will return to this and show how we can use the template system to							separate code and output once again.</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para">							Line 41: An <tt class="monospace">didSelectItem</tt> function. This function will be called by the list when someone							has clicked on an item.</p></p></li></ul>				With the code in our controller and the page file changed, we can now update our page and should get something that looks very				similar to this:			</p><img src="wf_tasks_listitems.png" align="center" /><p class="para">				If you add a new task it will now appear in the list, you can also click on a task and it'll be selected. Let quickly write the				<tt class="monospace">didSelectItem</tt> function, when a task is clicked we will set the <tt class="monospace">Add New Task</tt> components to the task values.</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br /></pre></td><td><pre class="code-linesright">function didSelectItem( object sender, string id ) {
&nbsp;&nbsp;&nbsp;&nbsp;object task = Task.load(id.toNumber());
&nbsp;&nbsp;&nbsp;&nbsp;.TaskTitle.setTextValue( task.title );
&nbsp;&nbsp;&nbsp;&nbsp;.TaskContents.setTextValue( task.contents );
&nbsp;&nbsp;&nbsp;&nbsp;.TaskPriority.setSelectedItem( task.priority );
&nbsp;&nbsp;&nbsp;&nbsp;.TaskCompleteBy.setDate( task.completedBy );
}</pre></td></tr></table><p class="para">				This sets the values and gives us something that works like this and concludes this section:			</p><img src="wf_tasks_listclicked.png" align="center" /></blockquote><a name="storedobjects.extras"></a><a name="74-otherfeaturesofstoredobject"></a><h2 class="sectionTitle">7.4. Other Features of StoredObject<a href="#toc"><img border="0" src="http-int.png" /></a></h2><blockquote class="section"><p class="para">				There are some other goodies that <tt class="monospace">Database.StoredObject</tt> listed here:<ul class="list"><li class="listItem"><p class="listItemParagraph"><p class="para"><tt class="monospace">deleteObject()</tt>: Delete the object out of the database.</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para"><tt class="monospace">objectID()</tt>: Get the id for the object.</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para"><tt class="monospace">setIDField()</tt>: Use this in the constructor. This allows you to change the default field							that <tt class="monospace">StoredObject</tt> uses. By default it uses 'id'.</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para"><tt class="monospace">packStructure()</tt>: This takes an argument of any type, serializes it to xml ready to be							stored in the database and returns it.						</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para"><tt class="monospace">unpackStructure()</tt>: This takes the string that was previously produced from 							<tt class="monospace">packStructure()</tt> and rebuilds the value for you.</p></p></li></ul>				It is recommended that you take a look at the <tt class="monospace">webframework</tt> api documentation.</p></blockquote></blockquote> <hr class="sectionSplitter" /><a name="pages2"></a><a name="8-pagesreloadedtemplates"></a><h1 class="sectionTitle">8. Pages Reloaded: Templates<a href="#toc"><img border="0" src="http-int.png" /></a></h1><blockquote class="section"><p class="para">			There are two topics under the same template roof that will be covered here. How to change the default template to have your			own custom style and using the template module apis within <tt class="monospace">webframework</tt>.		</p><a name="pages2.maintemplate"></a><a name="81-pagetemplates"></a><h2 class="sectionTitle">8.1. Page Templates<a href="#toc"><img border="0" src="http-int.png" /></a></h2><blockquote class="section"><p class="para">				When <tt class="monospace">webframework</tt> builds the final html for display, it asks the page controller for the name of the template to use.				This is done by calling the <strong class="strong">static</strong><tt class="monospace">getWrapperTemplateName()</tt> function which, by default, 				returns "Default". When changing the template you have one of two choices, either change the template name or just override the 				default template. We will chose the second option.</p><p class="para">				The first thing we do is create a directory called <tt class="monospace">Default.template</tt> in our <tt class="monospace">Resources</tt>				directory. We also create a CSS, HTML and Images directory within it. Within the HTML directory we create <tt class="monospace">PageHeader.html</tt>				and a <tt class="monospace">PageFooter.html</tt> files.</p><img src="wf_tasks_defaulttemplate.png" align="center" /><p class="para">				The we shall create a bare basic template for the page header. There are a few things to note, because				when combined with the page file, <tt class="monospace">webframework</tt> uses the file as a valid xml document which is	processed by the component 				and xhtml translation engine. For this to work cleanly it is important to add some non-optional extra mark up. The first line must				always be present as well as the extra attributes in the <tt class="monospace">html</tt> tag.</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br /></pre></td><td><pre class="code-linesright">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd"&gt;
&lt;html xmlns='http://www.w3.org/1999/xhtml' xmlns:wf='http://webframework.ferite.org'&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;&lt;wf:PlainText ID="PageTitle" /&gt;&lt;/title&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;h1&gt;Our New Template Works!&lt;/h1&gt;</pre></td></tr></table><p class="para">				Combined with the simple page footer:			</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br /></pre></td><td><pre class="code-linesright">&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;
&lt;/html&gt;</pre></td></tr></table><p class="para">				We are presented with something that looks like this (note the heading and the lack of background):			</p><img src="wf_tasks_newtemplate.png" align="center" /><p class="para">				If you have CSS or images that you wish to reference in your template you are faced with a slight problem. How do you know where				the application is within the system ? Well, this is the 1% where we can put some code in the template. This is naughty and 				cleaner mechanisms are being experimented with, in the mean time we will let you into a secret, the generated page is pushed through				<tt class="monospace">embfer</tt>. So we can put some embfer tags into our source. The code below shows two examples of how to use				<tt class="monospace">uriForTemplateResource</tt> function to generate a url for a resource. Lines 1-3 are the embedding of a css 				style sheet and line 4 is an image.</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br /></pre></td><td><pre class="code-linesright">&lt;style type="text/css" media="screen"&gt;
    @import url( <strong class="strong">&lt;?= uriForTemplateResource('Default') ?&gt;</strong>&lt;/strong&gt;/CSS/style.css );
&lt;/style&gt;
&lt;img src="<strong class="strong">&lt;?= uriForTemplateResource('Default') ?&gt;</strong>/Images/Logo.png" /&gt;</pre></td></tr></table><p class="para">				It it important to note that due to the caching system that <tt class="monospace">webframework</tt> employs, when you change a templates header or footer,				you must <tt class="monospace">touch</tt> all the pages that use it. This is because checking on every page load for a template load				can be very costly. This can be made more autonomous but using Cache Triggers which is covered later. Having just touched the				main page in <tt class="monospace">tasks</tt>, it is now possible to see an image I added:			</p><img src="wf_tasks_withlogo.png" align="center" /></blockquote><a name="pages2.smalltemplates"></a><a name="82-smalltemplates"></a><h2 class="sectionTitle">8.2. Small Templates<a href="#toc"><img border="0" src="http-int.png" /></a></h2><blockquote class="section"><p class="para">				Small templates are used in all components but can be used anywhere within the system. They use the <tt class="monospace">template</tt>				module to render and are fast and easy to use. We will look at how to use the template system by going back to <tt class="monospace">tasks</tt>				and cleaning up the rendered tasks within our lists.			</p><p class="para">				First we need to create our template. We shall call it Task.template and create a blank file in <tt class="monospace">Resources/Templates</tt>.				It needs to have some content otherwise we will end up with no output, so lets re-create our existing output with a few changes.			</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br /></pre></td><td><pre class="code-linesright">[templateValues:
&lt;b&gt;[title]&lt;/b&gt; &lt;br /&gt;
&lt;small&gt;Complete by: [completeby] &middot; Priority: &lt;b&gt;[priority]&lt;/b&gt;&lt;/small&gt; &lt;br /&gt;
&lt;blockquote style="border-left:2px dotted #666;margin-left:5px;padding-left:5px;"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;[content]
&lt;/blockquote&gt; ]</pre></td></tr></table><p class="para">				So what does the above mean ? Small templates use the template module to generate populated files. All values are passed into the				template through an associative array called <tt class="monospace">templateValues</tt>. To populate the above template we need some code				that looks something like this:			</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br /></pre></td><td><pre class="code-linesright">array values = [];
string ouput = '';
values['title'] = 'A Title';
values['content'] = 'Some content';
values['completeby'] = 'A Date';
values['priority'] = 'A Priority';
output = GUIKit.ViewTemplate.render('Task', values);</pre></td></tr></table><p class="para">				The important line in the code is line 7. It uses <tt class="monospace">GUIKit.ViewTemplate</tt> and calls the render function on it.				The first argument is always the name of the template to use: our template file is called 'Task.template' so we pass 'Task' as 				the name. The second argument is the associated values array. Executing the above code will produce this output:</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br /></pre></td><td><pre class="code-linesright">&lt;b&gt;A Title&lt;/b&gt; &lt;br /&gt;
&lt;small&gt;Complete by: A Date &middot; Priority: &lt;b&gt;A Priority&lt;/b&gt;&lt;/small&gt; &lt;br /&gt;
&lt;blockquote style="border-left:2px dotted #666;margin-left:5px;padding-left:5px;"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;Some content
&lt;/blockquote&gt;</pre></td></tr></table><p class="para">				The template module provides a good template language and it is recommended that you refer to the documentation for it. Our next				step is to transition our <tt class="monospace">renderForItem</tt> function to use the template code. The modified function looks like				this:</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br /></pre></td><td><pre class="code-linesright">function renderForItem( object sender, number index ) {
&nbsp;&nbsp;&nbsp;&nbsp;object task = .taskList[index];
&nbsp;&nbsp;&nbsp;&nbsp;array values = [];
&nbsp;&nbsp;&nbsp;&nbsp;values['title'] = task.title;
&nbsp;&nbsp;&nbsp;&nbsp;values['content'] = task.contents;
&nbsp;&nbsp;&nbsp;&nbsp;values['completeby'] = Date.date(task.completedBy).format(Config.Defaults.DateFormat);
&nbsp;&nbsp;&nbsp;&nbsp;values['priority'] = .TaskPriority.labelForItem(task.priority);
&nbsp;&nbsp;&nbsp;&nbsp;return GUIKit.ViewTemplate.render('Task', values);
}</pre></td></tr></table><p class="para">				The code is much cleaner and it is more obvious what is being attempted by it. We have also removed the display code from our logic				which means that we no longer need worry about presentation or potentially breaking code if we need to make presentation				changes. There are no good reasons why you shouldn't use this mechanism. If you are concerned about loading the template for				each item within the list - don't - the <tt class="monospace">ViewTemplate</tt> only ever loads a template once. The only thing left to 				do is see what the output looks like:</p><img src="wf_tasks_listtemplate.png" align="center" /></blockquote></blockquote> <hr class="sectionSplitter" /><a name="components"></a><a name="components.title"></a><h1 class="sectionTitle">9. Components: 42<a href="#toc"><img border="0" src="http-int.png" /></a></h1><blockquote class="section"><p class="para">			You have seen how to use components: drop their tag in the page file and link to them using the <tt class="monospace">[component]</tt> directive			in your controller class. The new trick we are going to learn is how to make our own components.</p><p class="para">			As with any good object oriented approach to development, the majority of the logic for a component is wrapped up in the			<tt class="monospace">GUIKit.View</tt> class and for container components there is some extra logic <tt class="monospace">GUIKit.Container</tt> class.			All components must inherit from either of these classes and be placed within the <tt class="monospace">GUIKit</tt> namespace. The namespace			part is critical, when <tt class="monospace">webframework</tt> is parsing the page files and encounters a component, it will look in the <tt class="monospace">GUIKit</tt>			for a class with the same name. e.g. &lt;wf:Button /&gt; maps to the class <tt class="monospace">GUIKit.Button</tt>.		</p><p class="para">			The following sub-sections cover the fundamental basics of standard and container components and it is recommended that you, upon			completing them, go an review the components that are shipped with <tt class="monospace">webframework</tt>. They can be found in the 			<tt class="monospace">Server/Suppoprt/GUIKit/Components</tt> directory.</p><a name="components.simple"></a><a name="91-standardcomponent"></a><h2 class="sectionTitle">9.1. Standard Component<a href="#toc"><img border="0" src="http-int.png" /></a></h2><blockquote class="section"><p class="para">				To start with we will create an empty component in the file <tt class="monospace">Support/Components/ExampleComponent.feh</tt>, 				making sure to add a <tt class="monospace">uses</tt> statement to our <tt class="monospace">App.fe</tt>.			</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br /></pre></td><td><pre class="code-linesright">namespace modifies GUIKit {
&nbsp;&nbsp;&nbsp;&nbsp;class ExampleComponent extends GUIKit.View {

&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;
}</pre></td></tr></table><p class="para">				The first thing we will do is add it to the top of our page file, and we will give it a text value as well. It should look something 				like this:			</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br /></pre></td><td><pre class="code-linesright">&lt;wf:ExampleComponent TextValue="This is an example component!" /&gt;</pre></td></tr></table><p class="para">				Refreshing the page will actually output nothing, which isn't surprising because we haven't told it how to draw our component to the page.				This is as easy as providing a <tt class="monospace">render</tt> function which returns the output. We will check whether we are supposed to				be visible or not, and simply return a bold version of our text value.</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br /></pre></td><td><pre class="code-linesright">function render() {
&nbsp;&nbsp;&nbsp;&nbsp;if( .visible() )
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return HTML.bold( .textValue() );
&nbsp;&nbsp;&nbsp;&nbsp;return ''; // We are not visible
}</pre></td></tr></table><p class="para">				If we refresh our page, we should get something that looks like this:			</p><img src="wf_tasks_examplecomponent1.png" align="center" /><p class="para">				Drawing is easy, but how can we have our own attributes on components like <tt class="monospace">TextValue</tt> ? For each attribute it is 				necessary create a function called <tt class="monospace">set<strong class="strong">AttributeName</strong></tt>. When <tt class="monospace">webframework</tt> sees an attribute				within a component tag it will check the component for a function that matches the attribute and will call it with the value in the				tag. For instance, the attributed <tt class="monospace">TextValue="foo"</tt> will cause the <tt class="monospace">setTextValue</tt> function 				to be called with the string <tt class="monospace">foo</tt> as the argument. There are already a number of attributes for the existing				components which can be seen in the api documentation. We will create a custom attribute called counter, it will count up each time				the page is loaded and allow us to set the initial value. When the component is rendered it will output the value at the end of our				string. With some changes the component code looks something like this (with the new function in bold):</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br />12<br />13<br />14<br />15<br /></pre></td><td><pre class="code-linesright">namespace modifies GUIKit {
&nbsp;&nbsp;&nbsp;&nbsp;class ExampleComponent extends GUIKit.View {

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong class="strong">number count = 0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function setCount( string count ) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.count = count.toNumber();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</strong>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function render() {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( .visible() )
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return <strong class="strong">"&lt;b&gt;${.textValue()}&lt;/b&gt;: ${.count}";</strong>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return ''; // We are not visible
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;
}</pre></td></tr></table><p class="para">				We can modify our page file:			</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br /></pre></td><td><pre class="code-linesright">&lt;wf:ExampleComponent TextValue="The answer is" Count="42" /&gt;</pre></td></tr></table><p class="para">				Which refreshing the page in the browser gives us:			</p><img src="wf_tasks_examplecomponent2.png" align="center" /><p class="para">				And refreshing will always give us 42. Which isn't what we want. To get our achieved goal of it automatically counting up we need to				delve into the state storing mechanism of <tt class="monospace">webframework</tt>. Every time a page of components are generated, <tt class="monospace">webframework</tt> will also ask				each and every component for their current state, or in <tt class="monospace">webframework</tt> parlance, their attributes. <tt class="monospace">webframework</tt> will call the<tt class="monospace">generateAttributes</tt> on each component which returns an associative array of attribute names to values. We need to				tap into this function and add out new attribute into the mix. When the components are loaded up, <tt class="monospace">webframework</tt> will automatically				call the right function to setup the component again (in exactly the same way attributes from the xml tags are given to the component).				Our function looks like this:</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br /></pre></td><td><pre class="code-linesright">function generateAttributes() {
&nbsp;&nbsp;&nbsp;&nbsp;array attrs = super.generateAttributes();
&nbsp;&nbsp;&nbsp;&nbsp;attrs['Count'] = "${.count}";
&nbsp;&nbsp;&nbsp;&nbsp;return attrs;
}</pre></td></tr></table><p class="para">				Modifying the <tt class="monospace">render</tt> to increment <tt class="monospace">count</tt> each, and every time, the component is drawn				makes it look something like this:</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br /></pre></td><td><pre class="code-linesright">function render() {
&nbsp;&nbsp;&nbsp;&nbsp;if( .visible() ) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong class="strong">.count = .count + 1;</strong>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return "&lt;b&gt;${.textValue()}&lt;/b&gt;: ${.count}";
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;return ''; // We are not visible
}</pre></td></tr></table><p class="para">				Now, when ever anything is done on the page, the counter will increment. For instance, adding a new task or selecting something from				the list. So you should not only be able to create a component, get it to render, add custom attributes, but also retain state across				page loads removing the need for anyone using the component to require the knowledge of the inner workings of the implementation. There				is one more point to cover before we venture into the realm that is the container components and that is using small templates. In the 				previous chapter we had to do build an array of values to be given to the template engine. With components there is a short cut, because				we already generate an array of attributes for the storage of information in the state saving part of <tt class="monospace">webframework</tt>, we can recycle that				information. There is a function provided by the <tt class="monospace">GUIKit.View</tt> class called<tt class="monospace">generateTemplateAttributes</tt>. This function called the existing <tt class="monospace">generateAttributes</tt>, does some				processing and returns a more template friendly set of values. The function takes the name of the default style class for the component				and will use that if a custom <tt class="monospace">StyleClass=""</tt> attribute isn't found. It also provides event handler code in a				key called <tt class="monospace">EventCode</tt>. So how do we invoke a component template draw ? First (as always) we create a template and,				following convention, we name it <tt class="monospace">Resources/Templates/Component<i class="emphasis">Name</i>.template</tt> which in our				case is <tt class="monospace">Resources/Templates/ComponentExampleComponent.template</tt> and it looks like this:</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br /></pre></td><td><pre class="code-linesright">[templateValues: 
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span class="[StyleClass]"&gt;&lt;b&gt;[TextValue]&lt;/b&gt;: &lt;i&gt;&lt;u&gt;[Count]&lt;/u&gt;&lt;/i&gt;&lt;/span&gt;
]</pre></td></tr></table><p class="para">				We now modify our render function to take advantage of this template. It is also important to note that we don't directly invoke				the <tt class="monospace">GUIKit.ViewTemplate.render</tt> function, this is because the component class allows the user of the component				to overload the name of the template to use when rendering the function. Calling <tt class="monospace">templateRender</tt> in the 				component will check to see if this is the case and change the template used. This is useful in case you wanted, for instance, two				different coloured buttons - a different template for each one and the name of the template given in a <tt class="monospace">Template=""</tt>				attribute within the page file.			</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br /></pre></td><td><pre class="code-linesright">function render() {
&nbsp;&nbsp;&nbsp;&nbsp;if( .visible() ) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array values = .generateTemplateAttributes('ExampleComponent');
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.count = .count + 1;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return .templateRender( 'ComponentExampleComponent', values );
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;return ''; // We are not visible
}</pre></td></tr></table><p class="para">				The last thing to cover with standard components is event handling. We will add some event handling so that the number 				only increments when we click on the component. We need to add two functions <tt class="monospace">initialiseComponent</tt> where				we will register our event handler, and a function <tt class="monospace">incrementCounter</tt> which will, as the name suggests,				increment the counter. We also remove the <tt class="monospace">.count = .count + 1;</tt> line from the render function.</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br /></pre></td><td><pre class="code-linesright">function initialiseComponent() {
&nbsp;&nbsp;&nbsp;&nbsp;super.initialiseComponent();
&nbsp;&nbsp;&nbsp;&nbsp;.registerEventHook( self, "incrementCounter", GUIKit.EvClick );
}
function incrementCounter( object sender, string extra ) {
&nbsp;&nbsp;&nbsp;&nbsp;.count++;
}</pre></td></tr></table><p class="para">				With the code in place we just need to edit our template to have the event code. This is stored in the key 				<tt class="monospace">EventCode</tt>, we also get the style settings using <tt class="monospace">Style</tt> as the<tt class="monospace">View</tt> class changes the default cursor for the mouse over the component to a hand to indicate				that the component can be clicked. Our new template looks like this and refreshing the page will allows us to click				on the component to change the value.</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br /></pre></td><td><pre class="code-linesright">[templateValues: 
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span class="[StyleClass]" [EventCode] style="[Style]"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;[TextValue]&lt;/b&gt;: &lt;i&gt;&lt;u&gt;[Count]&lt;/u&gt;&lt;/i&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt; 
]</pre></td></tr></table></blockquote><a name="components.container"></a><a name="92-strikeclassstrikeepicstrikecontainercomponents"></a><h2 class="sectionTitle">9.2. <strike class="strike">[Epic]</strike> Container Components<a href="#toc"><img border="0" src="http-int.png" /></a></h2><blockquote class="section"><p class="para">				A container component is slightly more tricky to play with than a normal component but that is because they can do more				interesting tricks. There are a number of container components that ship with <tt class="monospace">webframework</tt> with the most notable being				the <tt class="monospace">TabView</tt> component that makes adding tab based content a breeze. As with a standard component,				we shall lead by example. Creating a new component in <tt class="monospace">Support/Components/ExampleContainer.feh</tt> we				end up with a basic container that looks like this:</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br /></pre></td><td><pre class="code-linesright">namespace modifies GUIKit {
&nbsp;&nbsp;&nbsp;&nbsp;class ExampleContainer extends GUIKit.Container {

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function renderContainerStart() {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 'Container Start';
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function renderContainerEnd() {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 'Container End';
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre></td></tr></table><p class="para">				When it comes to rendering a container, <tt class="monospace">webframework</tt> will call <tt class="monospace">renderContainerStart</tt>, process the				container contents, then call <tt class="monospace">renderContainerEnd</tt>. To use the component, we add the source file to				<tt class="monospace">App.fe</tt> and put some more tags in our page file.</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br /></pre></td><td><pre class="code-linesright">&lt;wf:ExampleContainer&gt;
&nbsp;&nbsp;&nbsp;&nbsp;Some html &lt;b&gt;tags&lt;/b&gt; &lt;i&gt;italic&lt;/i&gt;
&lt;/wf:ExampleContainer&gt;</pre></td></tr></table><p class="para">				When we refresh the page we end up with something that looks like this:			</p><img src="wf_tasks_container1.png" align="center" /><p class="para">				Great! We can put stuff before and after some other page details. Not very exciting is it ? Never fear, <tt class="monospace">webframework</tt> has				many tricks up its sleeve. The first thing we will look at is controlling whether or not the contents of the container				should be rendered by the page. To do this we implement the function <tt class="monospace">renderContainerContents</tt> by default				it will return the same result as calling the function <tt class="monospace">visible</tt>. We will add a new attribute to the				component called <tt class="monospace">Expanded</tt> which, when true will render the contents of the component, otherwise it				wont.</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br />22<br />23<br />24<br />25<br />26<br />27<br />28<br /></pre></td><td><pre class="code-linesright">namespace modifies GUIKit {
&nbsp;&nbsp;&nbsp;&nbsp;class ExampleContainer extends GUIKit.Container {

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number expanded = 1;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function setExpanded( string value ) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.expanded = .stringToBoolean(value);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function generateAttributes() {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array attrs = super.generateAttributes();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attrs['Expanded'] = (.expanded ? 'true' : 'false');
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return attrs;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong class="strong">function renderContainerContents() {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return .expanded;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</strong>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function renderContainerStart() {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( .expanded )
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return "&lt;div&gt;&lt;b&gt;-&lt;/b&gt; &lt;u&gt;${.textValue()}&lt;/u&gt;&lt;/div&gt;&lt;blockquote&gt;";
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return "&lt;div&gt;&lt;b&gt;+&lt;/b&gt; &lt;u&gt;${.textValue()}&lt;/u&gt;&lt;/div&gt;";
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function renderContainerEnd() {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( .expanded )
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return "&lt;/blockquote&gt;";
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return '';
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre></td></tr></table><p class="para">				We also need to modify our page file accordingly:			</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br /></pre></td><td><pre class="code-linesright">&lt;wf:ExampleContainer TextValue="Top" Expanded="true"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;Some html &lt;b&gt;tags&lt;/b&gt; &lt;i&gt;italic&lt;/i&gt;
&lt;/wf:ExampleContainer&gt;

&lt;wf:ExampleContainer TextValue="Bottom" Expanded="false"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;If I was a cool person, I'd not mention WoW here.
&lt;/wf:ExampleContainer&gt;</pre></td></tr></table><img src="wf_tasks_container2.png" align="center" /><p class="para">				This renders to be something like the above. Pretty cool isn't it. <strong class="strong">BUT</strong> the magic doesn't stop there. The				next thing we will look at is attaching an event handler to the component so that clicking the text will expand and				collapse the component! First we register an event hook, then we write a event handler and then we smile. All we need to				do is add the following functions to our component:</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br /></pre></td><td><pre class="code-linesright">function initialiseComponent() {
&nbsp;&nbsp;&nbsp;&nbsp;super.initialiseComponent();
&nbsp;&nbsp;&nbsp;&nbsp;.registerEventHook( self, "toggleExpand", GUIKit.EvClick );
}
function toggleExpand( object sender, string extra ) {
&nbsp;&nbsp;&nbsp;&nbsp;.expanded = not .expanded;
}</pre></td></tr></table><p class="para"><tt class="monospace">initialiseComponent</tt> is the init function called when the component is first initialised and is the 				component equivalent to <tt class="monospace">initialiseComponents</tt> in the Page-Contoller classes.				We need to add the event code to our output, we do this by using the <tt class="monospace">eventHooks</tt> function (don't				worry we will finish this up with templates). We also use the function <tt class="monospace">styleSheetSettings</tt> which 				will generate a set of CSS style attributes based up the component state, the most important one we use is the change				of the pointer to a hand.</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br /></pre></td><td><pre class="code-linesright">function renderContainerStart() {
&nbsp;&nbsp;&nbsp;&nbsp;if( .expanded )
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return "&lt;div ${.eventHooks()} style=\"${.styleSheetSettings()}\"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;-&lt;/b&gt; &lt;u&gt;${.textValue()}&lt;/u&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&lt;blockquote&gt;";
&nbsp;&nbsp;&nbsp;&nbsp;else
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return "&lt;div ${.eventHooks()} style=\"${.styleSheetSettings()}\"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;+&lt;/b&gt; &lt;u&gt;${.textValue()}&lt;/u&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;";
}</pre></td></tr></table><p class="para">				When we refresh, we get this: 			</p><img src="wf_tasks_container3.png" align="center" /><p class="para">				The next facility that container classes provide is the ability to post-process the contents of the container before it				is outputted. What does this allow us to do ? Well, say we want to make everything uppercase within our container, this				is a trivial task. There is a function <tt class="monospace">preProcessContainerContents</tt> that gets called with the fully				rendered contents of the container. By default the function returns the contents untouched, however, we will change that.</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br /></pre></td><td><pre class="code-linesright">function preProcessContainerContents( string value ) {
&nbsp;&nbsp;&nbsp;&nbsp;return String.toUpper(value);
}</pre></td></tr></table><p class="para">				This changes our output to be like this:			</p><img src="wf_tasks_container4.png" align="center" /><p class="para">				As easy as this ability to change the contents is, it poses some issues. What happens if there is another component within				us ? What happens when you make changes that ends up breaking the page ? These are questions that you need to be asking				yourself when considering the change. There is a solution that is provided by <tt class="monospace">webframework</tt>, when the page is being passed				it will call the function <tt class="monospace">handleChildren</tt> providing an array of child nodes 				(<tt class="monospace">XML.Element</tt> objects). We can use this mechanism to delete nodes from the parsed tree before they				even get registered as components. How is this used ? For instance the <tt class="monospace">TabView</tt> component will remove				any nodes from below it in the document tree that are not <tt class="monospace">TabViewItem</tt> components. We will give				an example of this by removing all top level components from within our container.</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br /></pre></td><td><pre class="code-linesright">function handleChildren( array children, object renderEngine ) {
&nbsp;&nbsp;&nbsp;&nbsp;Array.each( children ) using ( child ) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array a = child.getNamespace();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( Array.keyExists( a, "wf" ) )
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;child.removeSelf();
&nbsp;&nbsp;&nbsp;&nbsp;};
}</pre></td></tr></table><p class="para">				The above code goes through each element within the array, checks to see if it is part of the <tt class="monospace">wf</tt>				namespace and if it is it will remove it from the tree of nodes. We can take a look at the effect of having this function				by comparing the difference of the output of this page code:			</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br /></pre></td><td><pre class="code-linesright">&lt;wf:ExampleContainer TextValue="Top" Expanded="true"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;Some html &lt;b&gt;tags&lt;/b&gt; &lt;i&gt;italic&lt;/i&gt; 
&nbsp;&nbsp;&nbsp;&nbsp;&lt;wf:Button TextValue="I Shouldn't Be Here Today" /&gt;
&lt;/wf:ExampleContainer&gt;</pre></td></tr></table><p class="para">				With out the <tt class="monospace">handleChildren</tt> implemented within the component class:</p><img src="wf_tasks_container5.png" align="center" /><p class="para">				When the function is enabled we are returned to our previous state:			</p><img src="wf_tasks_container4.png" align="center" /><p class="para">				It is important to note that this will <strong class="strong">only</strong> happen when the page is being re-cached. The last thing that				we need to do is transition the component over to using template to generate view code. We create two templates called<tt class="monospace">ComponentExampleContainerStart.template</tt> and <tt class="monospace">ComponentExampleContainerEnd.template</tt>, 				placing them in our templates directory. We then fill them out like below (The 'Start' and 'End' template respectively). It 				is important to note that we use a template conditional to output the blockquote tag.			</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br /></pre></td><td><pre class="code-linesright">[templateValues:
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div [EventCode] style="[Style]"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;[IsExpanded:-][!IsExpanded:+]&lt;/b&gt; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;u&gt;[TextValue]&lt;/u&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;
&nbsp;&nbsp;&nbsp;&nbsp;[IsExpanded: &lt;blockquote&gt; ]
]</pre></td></tr></table><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br /></pre></td><td><pre class="code-linesright">[templateValues:
&nbsp;&nbsp;&nbsp;&nbsp;[IsExpanded: &lt;/blockquote&gt;]
]</pre></td></tr></table><p class="para">				With the templates written we now need to hook them up to the render functions. They look like below and use a variation				of <tt class="monospace">templateRender</tt>. 			</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br /></pre></td><td><pre class="code-linesright">function renderContainerStart() {
&nbsp;&nbsp;&nbsp;&nbsp;array values = .generateTemplateAttributes('ExampleContainer');
&nbsp;&nbsp;&nbsp;&nbsp;values['IsExpanded'] = .expanded;
&nbsp;&nbsp;&nbsp;&nbsp;return .templateRender( 'ComponentExampleContainer', 'Start', values );
}
function renderContainerEnd() {
&nbsp;&nbsp;&nbsp;&nbsp;array values = .generateTemplateAttributes('ExampleContainer');
&nbsp;&nbsp;&nbsp;&nbsp;values['IsExpanded'] = .expanded;
&nbsp;&nbsp;&nbsp;&nbsp;return .templateRender( 'ComponentExampleContainer', 'End', values );
}</pre></td></tr></table><p class="para">				As with the standard component, a user could use the <tt class="monospace">Template=""</tt>				attribute. That works fine for a component that only uses one, but what about out container ? We use variants on the template.				Our default templates are <tt class="monospace">ComponentExampleContainerStart</tt> and <tt class="monospace">ComponentExampleContainerEnd</tt>,				this is because we specify the template <tt class="monospace">ComponentExampleContainer</tt> and the variant 'Start' or 'End'. If				someone was to change our template using <tt class="monospace">Template="GreenContainer"</tt>, rendering would not break because				it'd look for the variants <tt class="monospace">GreenContainerStart.template</tt> and<tt class="monospace">GreenContainerEnd.template</tt>. Powerful flexibility at little cost. When viewing the template version of				the component, the output should be identical to the previous version.			</p></blockquote></blockquote> <hr class="sectionSplitter" /><a name="i18n"></a><a name="i18n.title"></a><h1 class="sectionTitle">10. Internationalisation (i18n)<a href="#toc"><img border="0" src="http-int.png" /></a></h1><blockquote class="section"><p class="para">			Good communication is the <i class="emphasis">key</i> to a long and happy life. Well, maybe not the <i class="emphasis">key</i>, but it helps.			<tt class="monospace">webframework</tt> provides a number of tools that allow you to, at the moment, localise a web application to different languages. More tools			are planned in the future, such as date and currency formatting. There are two parts: building the translation catalog and loading it, the first			is the tricky part and the second bit is easy. <tt class="monospace">webframework</tt> provides a script within the <tt class="monospace">Tools</tt> directory 			called <tt class="monospace">i18nGenerateStrings.fe</tt>. The program will generate a strings file for the entire application which map the original			strings to a translated string, the generated file is placed within the application directory <tt class="monospace">Resources/Strings</tt>			and is called <tt class="monospace">Master.strings.fe</tt> (It is copies of this file that need to be translated).</p><p class="para">			Firstly we will look at how to tag strings so they make it into the strings.fe file, some guidelines on then translating the file and then 			how to use it within the running application.		</p><a name="101-taggingstrings"></a><h2 class="sectionTitle">10.1. Tagging Strings<a href="#toc"><img border="0" src="http-int.png" /></a></h2><blockquote class="section"><p class="para"><tt class="monospace">webframework</tt> provides three mechanisms for tagging a string to be translated and a tool to scan the applications source and				provide translate-able strings.<ul class="list"><li class="listItem"><p class="listItemParagraph"><p class="para">							All <tt class="monospace">TextValue=""</tt> attributes within the page files will be tagged for translation. <tt class="monospace">webframework</tt> will							create a list of all the <tt class="monospace">TextValue</tt> strings within a page and store them to be used by the<tt class="monospace">i18nGenerateStrings.fe</tt> tool.</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para">							There is a function within the framework called <tt class="monospace">I()</tt>. When the function is run takes a string and will 							return the translated string from the loaded catalog. It is very important to note how this function must be used for the							internationalisation tools to pick up the string when scanning the source code. There is only one argument and that is a 							string constant wrapped in single quotes <tt class="monospace">''</tt>. You must not use double quoted strings, the reason for							this restriction is that double quoted string are mutable due to variable substitution, this could have odd side effects							when being expanded and also increases the complexity for the translators.						</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br /></pre></td><td><pre class="code-linesright">I('This is correct')
I("This is not correct")</pre></td></tr></table><p class="para">							Using this function call we can update our application, where we set the priority for the task manually, so that the list							can be translated:						</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br /></pre></td><td><pre class="code-linesright">.TaskPriority.setDataSource( [
&nbsp;&nbsp;&nbsp;&nbsp;[ 1, <strong class="strong">I('Low')</strong> ],
&nbsp;&nbsp;&nbsp;&nbsp;[ 2, <strong class="strong">I('Medium')</strong> ],
&nbsp;&nbsp;&nbsp;&nbsp;[ 3, <strong class="strong">I('High')</strong> ] ] );</pre></td></tr></table><p class="para">							The restrictions on the input string unfortunately provides a little conundrum: how can we build dynamic strings that are easy to 							translate? There is a an answer, <tt class="monospace">webframework</tt> provides a <tt class="monospace">String.expand()</tt> function that provides a nice 							clean way of expanding strings. We shall start off with an example:</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br /></pre></td><td><pre class="code-linesright">string s = String.expand('A <strong class="strong">{0}</strong> Of How To <strong class="strong">{1:action}</strong>', 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Guide', 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Dance On The Roof');</pre></td></tr></table><p class="para">							The above code will expand the string to <i class="emphasis">A Guide Of How To Dance On The Roof</i>. The important parts of							the format string are in bold; they are called anchors. An anchor consists of a number and an optional note, in the above							example there are two anchors. The number denotes the location of the variable to substitute starting at the 0 index. So							the first item after the string will be 0, the seoncond 1 and so on. The note is not necessary, it is there to provide							context to the person reading the string as to what is going to be placed there, this is useful in situations where ordering							matters. For instance, in displaying currency, in the US, the symbol goes before the total, in Sweden, it goes after.						</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br /></pre></td><td><pre class="code-linesright">I('Total amount: {0:currency symbol}{1:amount}').expand(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getCurrencySymbol(), getAmount())</pre></td></tr></table><p class="para">							The English version is fine and would translate to something like: <tt class="monospace">Total amount: $100</tt>. However, translated 							to Swedish we have to re-order the arguments and the string would look like this:						</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br /></pre></td><td><pre class="code-linesright">'Summa: {1:amount}{0:currency symbol}</pre></td></tr></table><p class="para">							Resulting in an expansion that looks like: <tt class="monospace">Summa: 100kr</tt>. The reason this method is excellent is because							no code has had to change as a result of the translation.						</p></p></li><li class="listItem"><p class="listItemParagraph"><p class="para">							&lt;i18n&gt;&lt;/i18n&gt; tags are the third tool that can be used. This allows you to in page and template files, tag the text that should 							be translated. This allows you to, in an xml friendly fashion, get the same effect at using the <tt class="monospace">I('')</tt> function							call. It is <strong class="strong">important</strong> to note that the tag can <strong class="strong">not</strong> have any other tags within it. So how is this							used? Lets refer to our tasks application:</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br /></pre></td><td><pre class="code-linesright">&lt;wf:ExampleContainer TextValue="Bottom" Expanded="false"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;i18n&gt;If I was a cool person, I'd not mention a computer game here.&lt;/i18n&gt;
&lt;/wf:ExampleContainer&gt;

&lt;i18n&gt;This is translated text&lt;/i18n&gt;, but this isn't.</pre></td></tr></table><p class="para">							In the above example, the strings <i class="emphasis">If I was a cool person, I'd not mention a computer game here.</i> and<i class="emphasis">This is translated text</i> will be put within the <tt class="monospace">strings.fe</tt> file. These tags can be							used within <tt class="monospace">.template</tt> files with <tt class="monospace">webframework</tt> automatically translating the tags on the fly through							use of <tt class="monospace">ViewTemplate</tt> functions.</p></p></li></ul></p><p class="para">				Having tagged up our application we need to make sure that <tt class="monospace">webframework</tt> has generated the necessary files for all the pages, at the moment				this requires you to visit each page within the system, this will cause <tt class="monospace">webframework</tt> to correctly generate the per-page cache strings. Once				this is done we can run <tt class="monospace">i18nGenerateStrings.fe</tt>. This is run from within the Tools directory and takes the application				name as the only argument. For our tasks application we do the following:			</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br />22<br />23<br />24<br />25<br />26<br />27<br /></pre></td><td><pre class="code-linesright">chris:webframework$ cd Tools/
chris:Tools$ ferite i18nGenerateStrings.fe -- tasks
Checking against: Main.page
Checking against: ApplicationAdmin.page
Error with file: ../Cache/Server.Pages.ApplicationAdmin.page.cache.strings.fe
Checking against: Error.page
Error with file: ../Cache/Server.Pages.Error.page.cache.strings.fe
Checking against: Login.page
Error with file: ../Cache/Server.Pages.Login.page.cache.strings.fe
Checking against: WebframeworkQuickQuery.page
Error with file: ../Cache/Server.Pages.WebframeworkQuickQuery.page.cache.strings.fe
Walking directory ../Applications/tasks.app
Walk: ../Applications/tasks.app/App.fe
Walk: ../Applications/tasks.app/index.fe
Walk: ../Applications/tasks.app/Pages/Main.page.fe
Walk: ../Applications/tasks.app/Resources/Strings/se/tasks.strings.fe
Walk: ../Applications/tasks.app/Resources/Strings/tasks.strings.fe
Walk: ../Applications/tasks.app/Resources/Templates/ComponentExampleComponent.template
Walk: ../Applications/tasks.app/Resources/Templates/ComponentExampleContainerEnd.template
Walk: ../Applications/tasks.app/Resources/Templates/ComponentExampleContainerStart.template
Walk: ../Applications/tasks.app/Resources/Templates/Task.template
Walk: ../Applications/tasks.app/Support/Components/ExampleComponent.feh
Walk: ../Applications/tasks.app/Support/Components/ExampleContainer.feh
Walk: ../Applications/tasks.app/Support/LocalConfiguration.feh
Walk: ../Applications/tasks.app/Support/Task.fe
Writing file ../Applications/tasks.app/Resources/Strings/Master.strings.fe
chris:Tools$</pre></td></tr></table><p class="para">				The output is nice and verbose and tells us useful information, it tells us what page files it is looking at. Lines 5, 7, 10 show errors				that tell us that the tool can't find the strings file for that particular page which we can ignore if we don't want those translated.				Lines 12-25 show the application walking through the application looking for any template or ferite source files which it scans for				I('') function calls and &lt;i18n&gt;&lt;/i18n&gt; tags. Line 26 tells us that the file has been written out to disk in the location specified.			</p></blockquote><a name="102-thestringsfileandhowtotranslate"></a><h2 class="sectionTitle">10.2. The strings file and how to translate<a href="#toc"><img border="0" src="http-int.png" /></a></h2><blockquote class="section"><p class="para">				The <tt class="monospace">Master.strings.fe</tt> is actually a very simple ferite script, it returns an associative array that maps strings				to translated strings. The file for our tasks applications looks like this:</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br /></pre></td><td><pre class="code-linesright">return [
&nbsp;&nbsp;&nbsp;&nbsp;'Add New Task' =&gt; 'Add New Task',
&nbsp;&nbsp;&nbsp;&nbsp;'Add Task' =&gt; 'Add Task',
&nbsp;&nbsp;&nbsp;&nbsp;'Bottom' =&gt; 'Bottom',
&nbsp;&nbsp;&nbsp;&nbsp;'Complete by' =&gt; 'Complete by',
&nbsp;&nbsp;&nbsp;&nbsp;'Contents' =&gt; 'Contents',
&nbsp;&nbsp;&nbsp;&nbsp;'Error: Invalid Login Details' =&gt; 'Error: Invalid Login Details',
&nbsp;&nbsp;&nbsp;&nbsp;'Existing Tasks' =&gt; 'Existing Tasks',
&nbsp;&nbsp;&nbsp;&nbsp;'High' =&gt; 'High',
&nbsp;&nbsp;&nbsp;&nbsp;'If I was a cool person, I\'d not mention a computer game here.' =&gt; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'If I was a cool person, I\'d not mention a computer game here.',
&nbsp;&nbsp;&nbsp;&nbsp;'Low' =&gt; 'Low',
&nbsp;&nbsp;&nbsp;&nbsp;'Medium' =&gt; 'Medium',
&nbsp;&nbsp;&nbsp;&nbsp;'Priority' =&gt; 'Priority',
&nbsp;&nbsp;&nbsp;&nbsp;'The answer is' =&gt; 'The answer is',
&nbsp;&nbsp;&nbsp;&nbsp;'This is translated text' =&gt; 'This is translated text',
&nbsp;&nbsp;&nbsp;&nbsp;'Title' =&gt; 'Title',
&nbsp;&nbsp;&nbsp;&nbsp;'Top' =&gt; 'Top',
&nbsp;&nbsp;&nbsp;&nbsp;'Welcome to tasks' =&gt; 'Welcome to tasks',
&nbsp;&nbsp;&nbsp;&nbsp;'' =&gt; ''
];</pre></td></tr></table><p class="para">				Translation is as straight forward as replacing the strings to the right of the =&gt; with the translated string, saving the				file in a UTF-8 format in a directory denoting the language name in a file called <tt class="monospace">APPLICATION.strings.fe</tt>. So in the case of our application,			 	to translate to Swedish, we would save the file as <tt class="monospace">tasks.strings.fe</tt> in a directory called <tt class="monospace">se</tt> in the <tt class="monospace">Resources/Strings</tt> directory.</p><img src="wf_translated_folder.png" align="center" /><p class="para">				So what does a translated file look like?			</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br /></pre></td><td><pre class="code-linesright">return [
&nbsp;&nbsp;&nbsp;&nbsp;'Add New Task' =&gt; 'Lägg till Ny Uppgift',
&nbsp;&nbsp;&nbsp;&nbsp;'Add Task' =&gt; 'Lägg till Uppift',
&nbsp;&nbsp;&nbsp;&nbsp;'Bottom' =&gt; 'Botten',
&nbsp;&nbsp;&nbsp;&nbsp;'Complete by' =&gt; 'Slutförs av',
&nbsp;&nbsp;&nbsp;&nbsp;'Contents' =&gt; 'Innehåll',
&nbsp;&nbsp;&nbsp;&nbsp;'Error: Invalid Login Details' =&gt; 'Fel: Ogiltigt Login',
&nbsp;&nbsp;&nbsp;&nbsp;'Existing Tasks' =&gt; 'Befintliga Uppgifter',
&nbsp;&nbsp;&nbsp;&nbsp;'High' =&gt; 'Hög',
&nbsp;&nbsp;&nbsp;&nbsp;'If I was a cool person, I\'d not mention a computer game here.' =&gt; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'If I was a cool person, I\'d try my luck with several girls at the party saturday.',
&nbsp;&nbsp;&nbsp;&nbsp;'Low' =&gt; 'Låg',
&nbsp;&nbsp;&nbsp;&nbsp;'Medium' =&gt; 'Medel',
&nbsp;&nbsp;&nbsp;&nbsp;'Priority' =&gt; 'Prioritet',
&nbsp;&nbsp;&nbsp;&nbsp;'The answer is' =&gt; 'Svaret är',
&nbsp;&nbsp;&nbsp;&nbsp;'This is translated text' =&gt; 'Det här är översatt text',
&nbsp;&nbsp;&nbsp;&nbsp;'Title' =&gt; 'Titel',
&nbsp;&nbsp;&nbsp;&nbsp;'Top' =&gt; 'Toppen',
&nbsp;&nbsp;&nbsp;&nbsp;'Welcome to tasks' =&gt; 'Välkommen till Uppgifter',
&nbsp;&nbsp;&nbsp;&nbsp;'' =&gt; ''
];</pre></td></tr></table></blockquote><a name="103-loadingacatalog"></a><h2 class="sectionTitle">10.3. Loading A Catalog<a href="#toc"><img border="0" src="http-int.png" /></a></h2><blockquote class="section"><p class="para">				Loading a strings catalog is easy, you use the function call <tt class="monospace">I18N.loadCatalog(language);</tt>, where language is a string of				what language you wish to load. This should be done in the constructor for your application object. For instance, in our tasks application:			</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br /></pre></td><td><pre class="code-linesright">class tasksApplication extends Application {
&nbsp;&nbsp;&nbsp;&nbsp;constructor {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super("tasks");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.registerPage("Main");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;redirects.register( Application.NoAction, "Main" );&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong class="strong">I18N.loadCatalog( 'se' );</strong>
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre></td></tr></table><p class="para">				Once that is done, all that is left is to view our application translated:			</p><img src="wf_translated.png" align="center" /></blockquote></blockquote> <hr class="sectionSplitter" /><a name="ajax"></a><a name="ajax.title"></a><h1 class="sectionTitle">11. Asynchronous Mechanisms: AJAX to you and me.<a href="#toc"><img border="0" src="http-int.png" /></a></h1><blockquote class="section"><p class="para"><tt class="monospace">webframework</tt> provides a several closely related mechanisms for doing Asynchronous Javascript And XML (AJAX) and groups them under the			technology called Muliple Channel AJAX Model (MCAM). MCAM allows multiple AJAX requests and responses to be handled by the web application.			The result is a system that allows you to write your web applications regardless of whether they are going to be using the standard full			page reload or incremental changes using AJAX. For instance, say you had a button and when you click it the event handler updates a text 			box with the current time. Webframework knows which components have changed, it will package up changes on the page and send them back. 			The front end will take the changes and update the web page. None of your code has changed, except the event registration. It contrived 			example I'll admit, but it demonstrates the core functionality.</p><p class="para">			Lets start with a page with the old functionality. The page controller should look like this:		</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br />12<br /></pre></td><td><pre class="code-linesright">class TestPage extends GUIKit.Page {

&nbsp;&nbsp;&nbsp;&nbsp;[component TextBox, SubmitButton];

&nbsp;&nbsp;&nbsp;&nbsp;function initialiseComponents() {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.SubmitButton.registerEventHook( self, "buttonClick", GUIKit.EvClick );
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;function buttonClick( object sender, string extra ) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.TextBox.setTextValue('Date: ' + Date.date(Date.GMTnow()));
&nbsp;&nbsp;&nbsp;&nbsp;}
}
return TestPage;</pre></td></tr></table><p class="para">			With the page file looking like this:		</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br />2<br />3<br /></pre></td><td><pre class="code-linesright">A background event result:
&lt;wf:TextField ID="TextBox" TextValue="" Width="200px"/&gt;
&lt;wf:Button ID="SubmitButton" TextValue="Send" /&gt;</pre></td></tr></table><p class="para">			To help with the mental image of what the page looks like:		</p><img src="wf_ajax_start.png" align="center" /><p class="para">			The event flow is as previously described, the SubmitButton is clicked, the page submitted and buttonClicked is called. The next			task is to turn this into a Web 2.0 AJAX application. Now, watch very carefully, you might miss this: change line 6 in the above page			controller code to read like this:		</p><table width="100%" cellspacing=0 cellpadding=0><tr><td align="right" width="50"><pre class="code-linesleft">1<br /></pre></td><td><pre class="code-linesright">.SubmitButton.register<strong class="strong">Background</strong>EventHook( self, "buttonClick", GUIKit.EvClick );</pre></td></tr></table><p class="para">			The only thing you have to do, is register a background event hook. Apart from that, everything else is handled by webframework. When 			you refresh the page, you will be able to click on the button, the text box will update but it will all have been done in the background.			This effect works with webframework watching what components have changed and sending their updated display back to the browser. MCAM			goes through each change and updates the front end.		</p><a name="ajax.custom_data"></a><a name="111-fetchingcustomdata"></a><h2 class="sectionTitle">11.1. Fetching Custom Data<a href="#toc"><img border="0" src="http-int.png" /></a></h2><blockquote class="section"><p class="para"><i class="emphasis">Documentation here</i></p></blockquote><a name="ajax.custom_channels"></a><a name="112-customajaxchannels"></a><h2 class="sectionTitle">11.2. Custom AJAX Channels<a href="#toc"><img border="0" src="http-int.png" /></a></h2><blockquote class="section"><p class="para"><i class="emphasis">Documentation here</i></p></blockquote></blockquote> <hr class="sectionSplitter" /><a name="database"></a><a name="12-databaselayer"></a><h1 class="sectionTitle">12. Database Layer<a href="#toc"><img border="0" src="http-int.png" /></a></h1><blockquote class="section"><p class="para"><i class="emphasis">Documentation here</i></p></blockquote> <hr class="sectionSplitter" /><a name="documents"></a><a name="documents.title"></a><h1 class="sectionTitle">13. Documents. And their fore-fathers.<a href="#toc"><img border="0" src="http-int.png" /></a></h1><blockquote class="section"><p class="para"><i class="emphasis">Documentation here</i></p></blockquote> <hr class="sectionSplitter" /><a name="advanced"></a><a name="advanced.title"></a><h1 class="sectionTitle">14. Advanced Topics<a href="#toc"><img border="0" src="http-int.png" /></a></h1><blockquote class="section"><p class="para"><i class="emphasis">Documentation here</i></p><a name="advanced.security"></a><a name="141-security"></a><h2 class="sectionTitle">14.1. Security<a href="#toc"><img border="0" src="http-int.png" /></a></h2><blockquote class="section"><p class="para"><tt class="monospace">webframework</tt> provides a flexible security model for you to exploit based upon zones built from resources and users.</p><a name="advanced.security.structure"></a><a name="1411-structure"></a><h3 class="sectionTitle">14.1.1. Structure<a href="#toc"><img border="0" src="http-int.png" /></a></h3><blockquote class="section"><p class="para">					A resource is defined as a unique name that can be referred to within program code. Each zone consists of a set of users with a 					permission level assigned to each one, and a set of named resources which a permission level assigned to each one. Users and 					resources may be present in as many zones as required. How does the system work ? There are two functions 					<tt class="monospace">userAllowedForResource</tt> and <tt class="monospace">userAllowedForResourceInZone</tt>. The first takes a					user object and the name of a resource, checks all zones where the user and resource exist and if the user has a high enough					level to access that resource. The second function checks the specified zone, for the resource and user match.				</p></blockquote></blockquote><a name="advanced.cache"></a><a name="142-cachingandcachetriggers"></a><h2 class="sectionTitle">14.2. Caching and Cache Triggers<a href="#toc"><img border="0" src="http-int.png" /></a></h2><blockquote class="section"><p class="para"><i class="emphasis">Documentation here</i></p></blockquote></blockquote> <hr class="sectionSplitter" /><hr class="documentEnd" />
</body></html>
