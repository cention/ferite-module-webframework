<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta content="noindex, nofollow" name="robots">
		<script type="text/javascript">

var oEditor = window.parent.InnerDialogLoaded() ;
var FCK	= oEditor.FCK ;
var urlForApplicationAction = window.parent.parent.urlForApplicationAction ;
var activeArea = window.parent.parent.ActiveAreaID ;
var availableImages = window.parent.parent.AvailableImages ;
var availableImagesOrder = window.parent.parent.AvailableImagesOrder ;
var imageAreas = new Array() ;
var imageList ;
var imageContainer ;
var currentImage ;

function OnLoad()
{
	// First of all, translate the dialog box texts.
	// oEditor.FCKLanguageManager.TranslatePage( document ) ;
	
	var images ;
	
	window.parent.SetOkButton( true ) ;
	
	imageList = document.getElementById( 'imageList' ) ;
	previewImage = document.getElementById( 'previewImage' ) ;
	imageContainer = document.getElementById( 'imageContainer' ) ;
	
	imageList.disabled = true;
	
	if ( activeArea > 0 )
	{
		images = availableImages['' + activeArea] ;
	}
	else
	{
		images = new Array() ;
		
		for ( i = 0; i < availableImagesOrder.length; i++ )
		{
			var area = availableImagesOrder[i] ;
			
			for ( j = 0; j < availableImages[area].length; j++ )
			{
				images.push( availableImages[area][j] ) ;
			}
		}
	}
	
	if( images ) {
		for ( i = 0; i < images.length; i++ )
		{
			var image = document.createElement( 'img' ) ;
			var item = document.createElement( 'option' ) ;
			
			item.value = images[i].id;
			item.text = images[i].name;
			
			try
			{
				imageList.add( item , null ) ; // standards compliant; doesn't work in IE
			}
			catch ( e )
			{
				imageList.add( item ) ; // // IE only
			}
			
			imageAreas[i] = images[i].area ;
			
			image.id = 'Image-' + images[i].id ;
			image.src = urlForApplicationAction( 'admin/areas/filearchive/-/image/' + images[i].area + '/' + images[i].id ) ;
			image.style.display = 'none' ;
			image.style.maxWidth = '100px' ;
			image.style.maxHeight = '100px' ;
			imageContainer.appendChild( image ) ;
			
			if( ! currentImage )
			{
				currentImage = image ;
			}
		}
	}
	
	imageList.disabled = false;
	
	ShowPreviewImage() ;
}

function Ok()
{
	var selectedItem = imageList.options[imageList.selectedIndex] ;
	var area = imageAreas[imageList.selectedIndex];
	var oImage = null;
	oEditor.FCKUndo.SaveUndoStep() ;
	oImage = FCK.InsertElement( 'img' ) ;
	oImage.src = urlForApplicationAction( 'admin/areas/filearchive/-/image/' + area + '/' + selectedItem.value ) ;
	return true ;
}

function ShowPreviewImage()
{
	var selectedItem = imageList.options[imageList.selectedIndex] ;
	var newImage = document.getElementById( 'Image-' + selectedItem.value ) ;
	currentImage.style.display = 'none' ;
	newImage.style.display = 'inline' ;
	currentImage = newImage ;
}

		</script>
	</head>
	<body onload="OnLoad()" scroll="no" style="overflow: hidden">
		<table border="0" cellpadding="2" cellspacing="3">
			<tr valign="top">
				<td>
					<div style="margin-bottom: 3px; padding-bottom: 2px">
						Embed image from area file archive:
					</div>
					<select id="imageList" onchange="ShowPreviewImage()">
					</select>
				</td>
				<td id="imageContainer" style="width: 100px ; height: 100px" align="center">
					<!-- <img id="previewImage" src=""  style="display: none; max-width: 100px; max-height: 100px" /> -->
				</td>
			</tr>
		</table>
	</body>
</html>
